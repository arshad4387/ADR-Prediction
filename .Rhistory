)
combined_plot
# Top 15 drugs with most side effects
top_drugs <- drug_se %>%
count(drugbank_name, sort = TRUE) %>%
slice_head(n = 15)
plot_drugs <- ggplot(top_drugs, aes(x = reorder(drugbank_name, n), y = n)) +
geom_col(fill = "#440154FF") +  # dark purple
coord_flip() +
labs(
title = "Top Drugs with Highest Side Effects",
subtitle = "Drugs associated with the greatest number of unique ADRs",
x = "Drug Name",
y = "Number of Side Effects"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 10)
)
# Top 15 most frequent side effects
top_side_effects <- drug_se %>%
count(side_effect_name, sort = TRUE) %>%
slice_head(n = 15)
plot_side_effects <- ggplot(top_side_effects, aes(x = reorder(side_effect_name, n), y = n)) +
geom_col(fill = "#31688EFF") +  # steel blue
coord_flip() +
labs(
title = "Top Most Frequent Side Effects",
subtitle = "Most pervasive clinical symptoms across dataset",
x = "Side Effect",
y = "Frequency (Number of Drugs)"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 10)
)
# Combining the plots side by side
combined_plot <- plot_drugs + plot_side_effects +
plot_layout(ncol = 2) +
plot_annotation(
theme = theme(plot.title = element_text(face = "bold", size = 16))
)
combined_plot
# Top 15 drugs with most side effects
top_drugs <- drug_se %>%
count(drugbank_name, sort = TRUE) %>%
slice_head(n = 15)
plot_drugs <- ggplot(top_drugs, aes(x = reorder(drugbank_name, n), y = n)) +
geom_col(fill = "#440154FF") +  # dark purple
coord_flip() +
labs(
title = "Top Drugs with Highest Side Effects",
subtitle = "Drugs associated with the greatest number of unique ADRs",
x = "Drug Name",
y = "Number of Side Effects"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 10)
)
# Top 15 most frequent side effects
top_side_effects <- drug_se %>%
count(side_effect_name, sort = TRUE) %>%
slice_head(n = 15)
plot_side_effects <- ggplot(top_side_effects, aes(x = reorder(side_effect_name, n), y = n)) +
geom_col(fill = "#31688EFF") +  # steel blue
coord_flip() +
labs(
title = "Top Most Frequent Side Effects",
subtitle = "Most pervasive clinical symptoms across dataset",
x = "Side Effect",
y = "Frequency (Number of Drugs)"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", size = 14),
plot.subtitle = element_text(size = 10)
)
# Combining the plots side by side
combined_plot <- plot_drugs + plot_side_effects +
plot_layout(ncol = 2) +
plot_annotation(
theme = theme(plot.title = element_text(face = "bold", size = 16))
)
combined_plot
# Heatmap plot
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
# Set the threshold
threshold <- 80
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
# We define 100 color breaks from 0 to 100 to fix the scale
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
cluster_rows = FALSE,      # No dendrograms
cluster_cols = FALSE,
show_rownames = TRUE,      # Enable Row Names
show_colnames = TRUE,      # Enable Column Names
fontsize_row = 6,          # Very small font to fit many names
fontsize_col = 6,          # Very small font to fit many names
cellwidth = 7,             # Fixed width for each cell (adjust as needed)
cellheight = 7,
angle_col = 45,            # Tilts the top labels for better spacing
color = colors,
breaks = breaks_list,      # Forces scale to be exactly 0 to 100
main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
border_color = NA,         # Remove borders for a smooth pixel look
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# Heatmap plot
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
# Set the threshold
threshold <- 80
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
# We define 100 color breaks from 0 to 100 to fix the scale
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
cluster_rows = FALSE,      # No dendrograms
cluster_cols = FALSE,
show_rownames = TRUE,      # Enable Row Names
show_colnames = TRUE,      # Enable Column Names
fontsize_row = 6,          # Very small font to fit many names
fontsize_col = 6,          # Very small font to fit many names
cellwidth = 7,             # Fixed width for each cell (adjust as needed)
cellheight = 7,
angle_col = 45,            # Tilts the top labels for better spacing
color = colors,
breaks = breaks_list,      # Forces scale to be exactly 0 to 100
main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
border_color = NA,         # Remove borders for a smooth pixel look
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
drug_se <- read.csv("Drug_side_effects.csv")
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# --- Step 2: High-Performance Matrix Math ---
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
threshold <- 80
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
# 3. Create the Heatmap
# We define 100 color breaks from 0 to 100 to fix the scale
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
cluster_rows = FALSE,      # No dendrograms
cluster_cols = FALSE,
show_rownames = TRUE,      # Enable Row Names
show_colnames = TRUE,      # Enable Column Names
fontsize_row = 6,          # Very small font to fit many names
fontsize_col = 6,          # Very small font to fit many names
cellwidth = 7,             # Fixed width for each cell (adjust as needed)
cellheight = 7,
angle_col = 45,            # Tilts the top labels for better spacing
color = colors,
breaks = breaks_list,      # Forces scale to be exactly 0 to 100
main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
border_color = NA,         # Remove borders for a smooth pixel look
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
drug_se <- read.csv("Drug_side_effects.csv")
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# --- Step 2: High-Performance Matrix Math ---
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
threshold <- 80
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
# --- CLUSTERING ENABLED ---
cluster_rows = TRUE,         # Orders drugs by similarity profile
cluster_cols = TRUE,         # Matches column order to row order
treeheight_row = 30,         # Shows a small dendrogram for grouping
treeheight_col = 30,
# --------------------------
show_rownames = TRUE,
show_colnames = TRUE,
fontsize_row = 6,
fontsize_col = 6,
cellwidth = 7,
cellheight = 7,
angle_col = 45,
color = colors,
breaks = breaks_list,
main = paste("Clustered Drug Similarity (Threshold >=", threshold, "%)"),
border_color = NA,
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# 3. Create the Heatmap
# We define 100 color breaks from 0 to 100 to fix the scale
# colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
# breaks_list <- seq(0, 100, length.out = 101)
# pheatmap(focused_matrix,
#          cluster_rows = FALSE,      # No dendrograms
#          cluster_cols = FALSE,
#          show_rownames = TRUE,      # Enable Row Names
#          show_colnames = TRUE,      # Enable Column Names
#          fontsize_row = 6,          # Very small font to fit many names
#          fontsize_col = 6,          # Very small font to fit many names
#          cellwidth = 7,             # Fixed width for each cell (adjust as needed)
#          cellheight = 7,
#          angle_col = 45,            # Tilts the top labels for better spacing
#          color = colors,
#          breaks = breaks_list,      # Forces scale to be exactly 0 to 100
#          main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
#          border_color = NA,         # Remove borders for a smooth pixel look
#          legend_breaks = c(0, 25, 50, 75, 100),
#          legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
drug_se <- read.csv("Drug_side_effects.csv")
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# --- Step 2: High-Performance Matrix Math ---
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
threshold <- 50
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
# --- CLUSTERING ENABLED ---
cluster_rows = TRUE,         # Orders drugs by similarity profile
cluster_cols = TRUE,         # Matches column order to row order
treeheight_row = 30,         # Shows a small dendrogram for grouping
treeheight_col = 30,
# --------------------------
show_rownames = TRUE,
show_colnames = TRUE,
fontsize_row = 6,
fontsize_col = 6,
cellwidth = 7,
cellheight = 7,
angle_col = 45,
color = colors,
breaks = breaks_list,
main = paste("Clustered Drug Similarity (Threshold >=", threshold, "%)"),
border_color = NA,
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# 3. Create the Heatmap
# We define 100 color breaks from 0 to 100 to fix the scale
# colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
# breaks_list <- seq(0, 100, length.out = 101)
# pheatmap(focused_matrix,
#          cluster_rows = FALSE,      # No dendrograms
#          cluster_cols = FALSE,
#          show_rownames = TRUE,      # Enable Row Names
#          show_colnames = TRUE,      # Enable Column Names
#          fontsize_row = 6,          # Very small font to fit many names
#          fontsize_col = 6,          # Very small font to fit many names
#          cellwidth = 7,             # Fixed width for each cell (adjust as needed)
#          cellheight = 7,
#          angle_col = 45,            # Tilts the top labels for better spacing
#          color = colors,
#          breaks = breaks_list,      # Forces scale to be exactly 0 to 100
#          main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
#          border_color = NA,         # Remove borders for a smooth pixel look
#          legend_breaks = c(0, 25, 50, 75, 100),
#          legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
drug_se <- read.csv("Drug_side_effects.csv")
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# --- Step 2: High-Performance Matrix Math ---
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
threshold <- 83
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
# --- CLUSTERING ENABLED ---
cluster_rows = TRUE,         # Orders drugs by similarity profile
cluster_cols = TRUE,         # Matches column order to row order
treeheight_row = 30,         # Shows a small dendrogram for grouping
treeheight_col = 30,
# --------------------------
show_rownames = TRUE,
show_colnames = TRUE,
fontsize_row = 6,
fontsize_col = 6,
cellwidth = 7,
cellheight = 7,
angle_col = 45,
color = colors,
breaks = breaks_list,
main = paste("Clustered Drug Similarity (Threshold >=", threshold, "%)"),
border_color = NA,
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# 3. Create the Heatmap
# We define 100 color breaks from 0 to 100 to fix the scale
# colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
# breaks_list <- seq(0, 100, length.out = 101)
# pheatmap(focused_matrix,
#          cluster_rows = FALSE,      # No dendrograms
#          cluster_cols = FALSE,
#          show_rownames = TRUE,      # Enable Row Names
#          show_colnames = TRUE,      # Enable Column Names
#          fontsize_row = 6,          # Very small font to fit many names
#          fontsize_col = 6,          # Very small font to fit many names
#          cellwidth = 7,             # Fixed width for each cell (adjust as needed)
#          cellheight = 7,
#          angle_col = 45,            # Tilts the top labels for better spacing
#          color = colors,
#          breaks = breaks_list,      # Forces scale to be exactly 0 to 100
#          main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
#          border_color = NA,         # Remove borders for a smooth pixel look
#          legend_breaks = c(0, 25, 50, 75, 100),
#          legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
drug_se <- read.csv("Drug_side_effects.csv")
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# --- Step 2: High-Performance Matrix Math ---
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
threshold <- 85
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
# --- CLUSTERING ENABLED ---
cluster_rows = TRUE,         # Orders drugs by similarity profile
cluster_cols = TRUE,         # Matches column order to row order
treeheight_row = 30,         # Shows a small dendrogram for grouping
treeheight_col = 30,
# --------------------------
show_rownames = TRUE,
show_colnames = TRUE,
fontsize_row = 6,
fontsize_col = 6,
cellwidth = 7,
cellheight = 7,
angle_col = 45,
color = colors,
breaks = breaks_list,
main = paste("Clustered Drug Similarity (Threshold >=", threshold, "%)"),
border_color = NA,
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# 3. Create the Heatmap
# We define 100 color breaks from 0 to 100 to fix the scale
# colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
# breaks_list <- seq(0, 100, length.out = 101)
# pheatmap(focused_matrix,
#          cluster_rows = FALSE,      # No dendrograms
#          cluster_cols = FALSE,
#          show_rownames = TRUE,      # Enable Row Names
#          show_colnames = TRUE,      # Enable Column Names
#          fontsize_row = 6,          # Very small font to fit many names
#          fontsize_col = 6,          # Very small font to fit many names
#          cellwidth = 7,             # Fixed width for each cell (adjust as needed)
#          cellheight = 7,
#          angle_col = 45,            # Tilts the top labels for better spacing
#          color = colors,
#          breaks = breaks_list,      # Forces scale to be exactly 0 to 100
#          main = paste("Drug and side effects similarity (Similarity >=", threshold, "%)"),
#          border_color = NA,         # Remove borders for a smooth pixel look
#          legend_breaks = c(0, 25, 50, 75, 100),
#          legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
# Heatmap plot
binary_df <- drug_se %>%
select(drugbank_name, side_effect_name) %>%
distinct() %>%
mutate(present = 1) %>%
pivot_wider(names_from = side_effect_name, values_from = present, values_fill = 0)
# Convert to Matrix
mat <- as.matrix(binary_df[,-1])
rownames(mat) <- binary_df$drugbank_name
# Calculate Intersection and Union for all 1020 drugs
intersection_matrix <- mat %*% t(mat)
side_effect_counts <- diag(intersection_matrix)
sum_matrix <- outer(side_effect_counts, side_effect_counts, "+")
union_matrix <- sum_matrix - intersection_matrix
# Calculate % Similarity (Jaccard Index)
similarity_matrix <- (intersection_matrix / union_matrix) * 100
similarity_matrix[is.na(similarity_matrix)] <- 0
# Set the threshold
threshold <- 80
keep_drugs <- rownames(similarity_matrix)[apply(similarity_matrix, 1, function(x) any(x >= threshold & x < 100))]
# Subset the matrix to only these drugs
focused_matrix <- similarity_matrix[keep_drugs, keep_drugs]
# We define 100 color breaks from 0 to 100 to fix the scale
colors <- colorRampPalette(c("#ffffff", "#deebf7", "#9ecae1", "#3182bd", "#08519c"))(100)
breaks_list <- seq(0, 100, length.out = 101)
pheatmap(focused_matrix,
# Clustering
cluster_rows = TRUE,
cluster_cols = TRUE,
treeheight_row = 30,
treeheight_col = 30,
show_rownames = TRUE,
show_colnames = TRUE,
fontsize_row = 6,
fontsize_col = 6,
cellwidth = 7,
cellheight = 7,
angle_col = 45,
color = colors,
breaks = breaks_list,
main = paste("Clustered Drug Similarity (Threshold >=", threshold, "%)"),
border_color = NA,
legend_breaks = c(0, 25, 50, 75, 100),
legend_labels = c("0%", "25%", "50%", "75%", "100% Shared"))
